# 17 C类：连续监听终端设备

实现C类选项的终端设备用于具有足够功率的应用，因此不需要最小化接收时间。

C类终端设备不应实现B类选项。

C类终端设备将尽可能经常使用RX2窗口参数进行监听。根据A类定义，当终端设备不在RX1上（a）发送或（b）接收时，终端设备应监听RX2。为此，它必须在上行链路传输结束和RX1接收窗口开始之间使用RX2参数打开一个短窗口，并且一旦RX1接收窗口关闭，务必切换到RX2接收参数；RX2接收窗口必须保持打开状态，直到终端设备发送另一条消息。

> 注意：如果在打开RX1窗口时设备正在使用RX2参数解调下行链路，则它应该放弃解调并切换到RX1接收窗口
>
> 注意：节点没有特定的消息告诉服务器它是一个C类节点。根据加入过程中传递的协议，服务器端的应用程序知道它来管理C类节点。

在C类模式下需要上行传输（DL MAC命令请求或处于确认模式的DL消息）的设备收到消息时，设备应在终端设备和网络服务器都知道的时间段内应答（带外供应信息）。

在超时到期之前，网络不应向设备发送任何新的确认消息或MAC命令。一旦超时到期或接收到任何上行消息后，网络就被允许发送新的DL消息。

## 17.1 C类的第二个接收窗口持续时间

C类设备实现与A类设备相同的两个接收窗口，但它们不会关闭RX2窗口，直到它们需要再次发送。因此他们几乎可以在任何时间在RX2窗口中接收下行链路，包括为了MAC命令或ACK传输而发送的下行链路。在发送结束和RX1接收窗口的开始之间，RX2频率和数据速率上的短暂监听窗口也打开。

![](.gitbook/assets/figure-65-class-c-end-device-reception-slot-timing.png)

## 17.2 C类组播下行链路

与B类类似，C类设备可以接收组播下行链路帧。组播地址和关联的网络会话密钥和应用会话密钥必须来自应用层。相同的限制适用于C类组播下行链路帧：

* 它们不应携带MAC命令，既不在**FOpt**字段中，也不在端口0的有效载荷中传送，因为组播下行链路不具有与单播帧相同的身份验证鲁棒性。
* **ACK**和**ADRACKReq**位必须为零。**MType**字段必须带有未确认数据下行的值。
* **FPending**位指示有更多的组播数据要发送。鉴于C类设备大多数时间保持其接收器处于活动状态，**FPending**位不会触发终端设备的任何特定行为。

